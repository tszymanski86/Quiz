<!DOCTYPE html>
<html lang="pl">

<head>
  <meta charset="UTF-8">
  <title>Quiz</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.13/semantic.min.css">
  <link href="styles.css" rel="stylesheet">
  <script src="https://unpkg.com/react/umd/react.development.js"></script>
  <script src="https://unpkg.com/react-dom/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/babel-standalone/babel.js"></script>
</head>

<body>
  <header>
    <h1>
      Mój pierwszy quiz
    </h1>
  </header>

  <main>
    <article>
        <form id='quiz'></form>
        <button id='check'>Sprawdź</button>
        <div id='verdict'></div>       
    </article>
  </main>

<script type='text/babel'>
let score = 0;
const btn = document.querySelector('#check');
btn.addEventListener('click',checkTheAnswers);

function checkTheAnswers(){
  data.forEach(function(answer, i){
    const questions = document.querySelectorAll(`input[name=question_${i}]`);
    questions.forEach(function(q){
      q.parentElement.classList.add('badAnswer');
      if (q.checked && q.value==answer.correctAnswer) {
        score++;
        q.parentElement.classList.toggle('badAnswer');
        q.parentElement.classList.add('goodAnswer');
      }
    });
  });
  document.querySelector('#verdict').innerHTML='Twój wynik: ' + score + 'pkt.';
  score = 0;
}

const data = [{
  question: 'Czy ten quiz jest łatwy?',
  answers: {
    a: 'Tak, bardzo łatwy',
    b: 'Trudny',
    c: 'W sam raz'
  },
  correctAnswer: 'b'
},
{
  question: 'Czy ten quiz jest przyjemny?',
  answers: {
    a: 'Tak, bardzo przyjemny',
    b: 'Okropny',
    c: 'Ujdzie',
  },
  correctAnswer: 'a'
},
{
  question: 'Czy chcesz więcej takich quizów?',
  answers: {
    a: 'Nigdy w życiu',
    b: 'Kopytko',
    c: 'Tak',
  },
  correctAnswer: 'c'
}
];

function QuestionItem({question, questionNumber, answers}){
  return(
    <fieldset> 
      <legend>
        {question}
      </legend>
      <div className='answers'>
        {Object.entries(answers).map(([k, v], i) => 
          <div className='answer' key={i}><label><input type='radio' name={questionNumber} value={k}/>{v}</label></div>)}
      </div>
    </fieldset>
  );
}

function Quiz(props){
    const content = props.data;
    const listItems = content.map((object,i) =>
        <li key={i}>
            <QuestionItem
                question={object.question}
                questionNumber={'question_'+i}
                answers={object.answers}
            />
        </li>
    );
  return (
    <ul>{listItems}</ul>
  );
}

ReactDOM.render(
  <Quiz data={data}/>,
  document.getElementById('quiz')
);

</script>
</body>
</html>